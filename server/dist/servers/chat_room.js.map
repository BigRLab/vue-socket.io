{"version":3,"sources":["../../src/servers/chat_room.js"],"names":["app","require","http","Server","io","errObj","result","content","module","exports","on","socket","obj","e","listen","chat_room_port","console","log"],"mappings":";;AAIA;;;;AACA;;;;AACA;;;;AALA,IAAIA,MAAMC,QAAQ,SAAR,GAAV;AACA,IAAIC,OAAOD,QAAQ,MAAR,EAAgBE,MAAhB,CAAuBH,GAAvB,CAAX;AACA,IAAII,KAAKH,QAAQ,WAAR,EAAqBC,IAArB,CAAT;;;AAWA,IAAMG,SAAS;AACbC,UAAQ,CADK;AAEbC,WAAS;AAFI,CAAf;;AAKAC,OAAOC,OAAP,GAAiB,YAAY;AAC3BL,KAAGM,EAAH,CAAM,YAAN,EAAoB,kBAAU;;AAE5B;AACAC,WAAOD,EAAP,CAAU,OAAV,EAAmB,UAAUE,GAAV,EAAe;AAChC,sCAAUD,MAAV,EAAkBC,GAAlB;AACD,KAFD;AAGA;AACAD,WAAOD,EAAP,CAAU,YAAV,EAAwB,UAAUE,GAAV,EAAe;AACrC,oDAAwBD,MAAxB,EAAgCC,GAAhC;AACD,KAFD;AAGA;AACAD,WAAOD,EAAP,CAAU,WAAV,EAAuB,YAAY;AACjC,yCAAaC,MAAb;AACD,KAFD;AAGA;AACAA,WAAOD,EAAP,CAAU,QAAV,EAAoB,UAAUE,GAAV,EAAe,CAElC,CAFD;;AAIA;AACAD,WAAOD,EAAP,CAAU,YAAV,EAAwB,UAAUG,CAAV,EAAa;AAAE;AACrC;AACA,2CAAeF,MAAf;AACD,KAHD;;AAKA;AACAA,WAAOD,EAAP,CAAU,SAAV,EAAqB,UAAUE,GAAV,EAAe;AAAE;AACpC,wCAAYD,MAAZ,EAAoBC,GAApB;AACD,KAFD;AAID,GA9BD;;AAgCAV,OAAKY,MAAL,CAAY,gBAAOC,cAAnB,EAAmC,YAAY;AAC7CC,YAAQC,GAAR,CAAY,aAAa,gBAAOF,cAAhC;AACD,GAFD;AAGD,CApCD","file":"chat_room.js","sourcesContent":["\r\nvar app = require('express')();\r\nvar http = require('http').Server(app);\r\nvar io = require('socket.io')(http);\r\nimport config from '../config/index.js';\r\nimport chatRobot from './chat_robot.js';\r\nimport {\r\n  loginFunc, \r\n  loginAndgetUserInfoFunc,\r\n  messageFunc,\r\n  disconnectFunc,\r\n  userListFunc\r\n} from './chat_room_async.js';\r\n\r\nconst errObj = {\r\n  result: 0,\r\n  content: '没有理解你的意思，你能说的简单一点吗？'\r\n};\r\n\r\nmodule.exports = function () {\r\n  io.on('connection', socket => {\r\n\r\n    // 登录\r\n    socket.on('login', function (obj) {\r\n      loginFunc(socket, obj);\r\n    });\r\n    // 自动登录并获取用户信息\r\n    socket.on('auto-login', function (obj) {\r\n      loginAndgetUserInfoFunc(socket, obj);\r\n    });\r\n    // 获取在线用户列表\r\n    socket.on('user-list', function () {\r\n      userListFunc(socket);\r\n    });\r\n    //监听新上线用户\r\n    socket.on('online', function (obj) {\r\n      \r\n    });\r\n\r\n    //监听用户退出\r\n    socket.on('disconnect', function (e) { // {userId: 1004}\r\n      // console.log('有用户推出了：', e);\r\n      disconnectFunc(socket);\r\n    });\r\n\r\n    //监听用户发布聊天内容\r\n    socket.on('message', function (obj) { // {fromId, toId, message}\r\n      messageFunc(socket, obj);\r\n    });\r\n\r\n  });\r\n\r\n  http.listen(config.chat_room_port, function () {\r\n    console.log('聊天工具启动: ' + config.chat_room_port);\r\n  });\r\n};\r\n"]}